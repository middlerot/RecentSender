<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RecentSender</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
}

body {
    background: #36393f;
    color: #dcddde;
    font-family: 'gg sans', 'Noto Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
}

/* Disable dev tools shortcuts */
body {
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
}

.discord-container {
    display: flex;
    height: 100vh;
}

.sidebar {
    width: 240px;
    background: #2f3136;
    padding: 12px;
    border-right: 1px solid #202225;
}

.server-icon {
    width: 48px;
    height: 48px;
    background: #5865f2;
    border-radius: 50%;
    margin: 0 auto 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: 700;
    color: white;
    cursor: pointer;
    transition: all 0.2s;
}

.server-icon:hover {
    border-radius: 16px;
    background: #4752c4;
}

.channel-list {
    margin-top: 16px;
}

.channel-category {
    color: #96989d;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    padding: 8px;
    letter-spacing: 0.5px;
}

.channel {
    padding: 8px;
    margin: 2px 0;
    border-radius: 4px;
    cursor: pointer;
    color: #96989d;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.15s;
}

.channel:hover {
    background: #393c43;
    color: #dcddde;
}

.channel.active {
    background: #404249;
    color: #fff;
}

.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #36393f;
}

.channel-header {
    height: 48px;
    background: #36393f;
    border-bottom: 1px solid #202225;
    padding: 0 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 16px;
    color: #fff;
}

.chat-area {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
}

.message-group {
    margin-bottom: 24px;
}

.message-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 4px;
}

.avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #5865f2;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    color: white;
    font-size: 16px;
}

.username {
    font-weight: 600;
    color: #fff;
    font-size: 16px;
}

.bot-badge {
    background: #5865f2;
    color: white;
    font-size: 10px;
    padding: 2px 4px;
    border-radius: 3px;
    font-weight: 600;
    text-transform: uppercase;
}

.timestamp {
    color: #72767d;
    font-size: 12px;
    margin-left: 4px;
}

.message-content {
    margin-left: 56px;
    color: #dcddde;
    line-height: 1.375rem;
    font-size: 16px;
}

.embed {
    max-width: 520px;
    background: #2f3136;
    border-left: 4px solid #5865f2;
    border-radius: 4px;
    padding: 12px 16px;
    margin-top: 8px;
}

.embed-title {
    color: #00b0f4;
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 8px;
}

.embed-description {
    color: #dcddde;
    line-height: 1.375rem;
}

.embed-field {
    margin: 12px 0;
}

.embed-field-name {
    color: #fff;
    font-weight: 600;
    margin-bottom: 4px;
    font-size: 14px;
}

.embed-field-value {
    color: #dcddde;
    font-size: 14px;
}

.input-group {
    margin: 16px 0;
}

.discord-input {
    width: 100%;
    background: #40444b;
    border: 1px solid #202225;
    border-radius: 8px;
    padding: 12px;
    color: #dcddde;
    font-size: 16px;
    font-family: inherit;
    transition: border 0.2s;
}

.discord-input:focus {
    outline: none;
    border-color: #00b0f4;
}

.discord-input::placeholder {
    color: #72767d;
}

.discord-button {
    background: #5865f2;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    font-family: inherit;
}

.discord-button:hover {
    background: #4752c4;
}

.discord-button:active {
    transform: translateY(1px);
}

.discord-button.success {
    background: #3ba55d;
}

.discord-button.success:hover {
    background: #2d7d46;
}

.discord-button.danger {
    background: #ed4245;
}

.discord-button.danger:hover {
    background: #c03537;
}

.discord-select {
    width: 100%;
    background: #40444b;
    border: 1px solid #202225;
    border-radius: 8px;
    padding: 12px;
    color: #dcddde;
    font-size: 16px;
    font-family: inherit;
    cursor: pointer;
}

.code-block {
    background: #2f3136;
    border: 1px solid #202225;
    border-radius: 8px;
    padding: 16px;
    margin: 12px 0;
    font-family: 'Consolas', 'Monaco', monospace;
    color: #f0f0f0;
    font-size: 14px;
    position: relative;
    user-select: text;
    -webkit-user-select: text;
    -moz-user-select: text;
}

.code-block-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    padding-bottom: 8px;
    border-bottom: 1px solid #40444b;
}

.code-block-lang {
    color: #72767d;
    font-size: 12px;
    text-transform: uppercase;
    font-weight: 600;
}

.copy-button {
    background: #4f545c;
    border: none;
    padding: 4px 12px;
    border-radius: 4px;
    color: #dcddde;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-button:hover {
    background: #5d6269;
}

.alert {
    background: #faa81a;
    color: #000;
    padding: 12px 16px;
    border-radius: 8px;
    margin: 12px 0;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
}

.alert.success {
    background: #3ba55d;
    color: white;
}

.alert.error {
    background: #ed4245;
    color: white;
}

.alert.info {
    background: #5865f2;
    color: white;
}

.verification-steps {
    background: #2f3136;
    border-radius: 8px;
    padding: 16px;
    margin: 12px 0;
}

.verification-steps ol {
    margin-left: 20px;
    line-height: 1.8;
}

.verification-steps li {
    margin: 8px 0;
    color: #dcddde;
}

.preview-section {
    background: #2f3136;
    border-radius: 8px;
    padding: 16px;
    margin-top: 16px;
}

.preview-header {
    color: #96989d;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    margin-bottom: 12px;
    letter-spacing: 0.5px;
}

.loading {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid #40444b;
    border-top-color: #5865f2;
    border-radius: 50%;
    animation: spin 0.6s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.status-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    margin-top: 8px;
}

.status-badge.verified {
    background: rgba(59, 165, 93, 0.2);
    color: #3ba55d;
}

.security-log {
    background: #2f3136;
    border-left: 3px solid #ed4245;
    padding: 12px;
    margin: 8px 0;
    border-radius: 4px;
    font-size: 14px;
}

/* Scrollbar */
::-webkit-scrollbar {
    width: 16px;
}

::-webkit-scrollbar-track {
    background: #2e3338;
}

::-webkit-scrollbar-thumb {
    background: #202225;
    border: 4px solid #2e3338;
    border-radius: 8px;
}

::-webkit-scrollbar-thumb:hover {
    background: #1a1c1f;
}

@media (max-width: 768px) {
    .sidebar {
        display: none;
    }
    
    .message-content {
        margin-left: 0;
    }
}

/* Security: Disable right-click context menu */
.no-context {
    pointer-events: none;
}
</style>
</head>
<body oncontextmenu="return false;" onkeydown="return disableDevTools(event);">

<div class="discord-container">
    <div class="sidebar">
        <div class="server-icon">RS</div>
        <div class="channel-list">
            <div class="channel-category">Security</div>
            <div class="channel active">
                <span></span> verification
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="channel-header">
            <span></span> verification
        </div>

        <div class="chat-area" id="chatArea">
            <!-- Step 1: Security Check -->
            <div class="message-group" id="step1" style="display:block;">
                <div class="message-header">
                    <div class="avatar">RS</div>
                    <span class="username">RecentSender</span>
                    <span class="bot-badge">BOT</span>
                    <span class="timestamp" id="timestamp1"></span>
                </div>
                <div class="message-content">
                    <div class="embed">
                        <div class="embed-title"> Security Verification Required</div>
                        <div class="embed-description">
                            Welcome to RecentSender. Before accessing this system, you must complete a security verification.
                        </div>
                        <div class="embed-field">
                            <div class="embed-field-name">Step 1: Enter Access Key</div>
                            <div class="input-group">
                                <input type="password" class="discord-input" id="accessKey" placeholder="Enter your access key..." />
                            </div>
                            <button class="discord-button" onclick="verifyAccessKey()">Verify Access Key</button>
                            <div id="keyStatus"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Roblox Username -->
            <div class="message-group" id="step2" style="display:none;">
                <div class="message-header">
                    <div class="avatar">RS</div>
                    <span class="username">RecentSender</span>
                    <span class="bot-badge">BOT</span>
                    <span class="timestamp" id="timestamp2"></span>
                </div>
                <div class="message-content">
                    <div class="embed">
                        <div class="embed-title">Roblox Account Verification</div>
                        <div class="embed-description">
                            Now we need to verify your Roblox account ownership. This ensures only authorized users can send webhooks.
                        </div>
                        <div class="embed-field">
                            <div class="embed-field-name">Enter Your Roblox Username</div>
                            <div class="input-group">
                                <input type="text" class="discord-input" id="robloxName" placeholder="Enter Roblox username..." />
                            </div>
                            <button class="discord-button success" onclick="initiateRobloxVerification()">Continue to Verification</button>
                            <div id="robloxStatus"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Bio Verification -->
            <div class="message-group" id="step3" style="display:none;">
                <div class="message-header">
                    <div class="avatar">RS</div>
                    <span class="username">RecentSender</span>
                    <span class="bot-badge">BOT</span>
                    <span class="timestamp" id="timestamp3"></span>
                </div>
                <div class="message-content">
                    <div class="embed">
                        <div class="embed-title">Add Code to Your Roblox Bio</div>
                        <div class="embed-description">
                            Copy the verification code below and add it to your Roblox profile bio.
                        </div>
                        <div class="embed-field">
                            <div class="embed-field-name">Your Verification Code</div>
                            <div class="code-block">
                                <div class="code-block-header">
                                    <span class="code-block-lang">Verification Code</span>
                                    <button class="copy-button" onclick="copyCode()">Copy</button>
                                </div>
                                <div id="verificationCode" style="font-size: 20px; font-weight: 700; color: #3ba55d; user-select: text; -webkit-user-select: text; -moz-user-select: text;">
                                    Loading...
                                </div>
                            </div>
                        </div>
                        <div class="verification-steps">
                            <strong style="color: #fff;">Instructions:</strong>
                            <ol>
                                <li>Copy the code above</li>
                                <li>Go to <a href="https://www.roblox.com/my/account#!/info" target="_blank" style="color: #00b0f4;">Roblox Account Settings</a></li>
                                <li>Paste the code in your bio</li>
                                <li>Click the button below to verify</li>
                            </ol>
                        </div>
                        <button class="discord-button success" onclick="verifyRobloxBio()">✓ Verify Bio Now</button>
                        <div id="bioStatus"></div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Main App -->
            <div class="message-group" id="step4" style="display:none;">
                <div class="message-header">
                    <div class="avatar">RS</div>
                    <span class="username">RecentSender</span>
                    <span class="bot-badge">BOT</span>
                    <span class="timestamp" id="timestamp4"></span>
                </div>
                <div class="message-content">
                    <div class="embed">
                        <div class="embed-title"> Verification Complete</div>
                        <div class="embed-description">
                            You're all set! You can now configure and send webhooks.
                            <div class="status-badge verified">
                                <span></span> Account Verified
                            </div>
                        </div>
                        
                        <div class="embed-field">
                            <div class="embed-field-name">Middleman Description</div>
                            <div class="input-group">
                                <input type="text" class="discord-input" id="item" placeholder="Example: Middlemanned 50k limited trade" oninput="updatePreview()" />
                            </div>
                        </div>

                        <div class="embed-field">
                            <div class="embed-field-name">Image URL (Optional)</div>
                            <div class="input-group">
                                <input type="text" class="discord-input" id="imageUrl" placeholder="https://example.com/image.png" oninput="updatePreview()" />
                            </div>
                        </div>

                        <div class="embed-field">
                            <div class="embed-field-name">Embed Style</div>
                            <div class="input-group">
                                <select class="discord-select" id="template" onchange="updatePreview()">
                                    <option value="default">Default - Full Details</option>
                                    <option value="compact">Compact - Minimal</option>
                                    <option value="imageOnly">Image Only - Visual</option>
                                </select>
                            </div>
                        </div>

                        <div class="embed-field">
                            <div class="embed-field-name">Embed Color</div>
                            <div class="input-group">
                                <input type="color" class="discord-input" id="embedColor" value="#5865F2" oninput="updatePreview()" style="height: 50px; cursor: pointer;" />
                            </div>
                        </div>

                        <button class="discord-button" onclick="sendWebhook()"> Send Webhook</button>
                        <div id="sendStatus"></div>

                        <div class="preview-section">
                            <div class="preview-header"> Live Preview</div>
                            <div id="previewEmbed"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
/* ========== SECURITY: DISABLE DEV TOOLS ========== */
function disableDevTools(e) {
    // Block F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+Shift+C
    if (e.keyCode === 123 || 
        (e.ctrlKey && e.shiftKey && e.keyCode === 73) ||
        (e.ctrlKey && e.shiftKey && e.keyCode === 74) ||
        (e.ctrlKey && e.keyCode === 85) ||
        (e.ctrlKey && e.shiftKey && e.keyCode === 67)) {
        e.preventDefault();
        return false;
    }
}

// Disable console
(function() {
    const noOp = () => {};
    const methods = ['log', 'debug', 'info', 'warn', 'error', 'table', 'trace', 'dir', 'group', 'groupCollapsed', 'groupEnd', 'clear'];
    methods.forEach(method => {
        console[method] = noOp;
    });
})();

// Detect dev tools
(function() {
    const element = new Image();
    Object.defineProperty(element, 'id', {
        get: function() {
            throw new Error('DevTools detected');
        }
    });
    setInterval(() => {
        console.log(element);
    }, 1000);
})();

/* ========== CONFIGURATION ========== */
const ACCESS_KEY = "MROT6283";
const WEBHOOK_URL = "https://discord.com/api/webhooks/1440098361800917044/jkjqamlAHKMiAUuEGJw1RmMFQdhYALCFsbAdnRB6zBpv94CJ_f5btbpIP8325gg_GyHg";
const SECURITY_WEBHOOK = "https://discord.com/api/webhooks/1440109096756973771/5IrXiB73A3adbEpvHECxl38F7MpEY5Im04zbNZCzcvSUskHe6zH6-uD5zvmxQ6WmpMub";

/* ========== STATE ========== */
localforage.config({
    name: "RecentSenderSecureDB",
    storeName: "verified_accounts_v3"
});

let verificationCode = "";
let robloxId = null;
let verifiedOwner = false;
let currentUsername = "";
let attemptCount = 0;

/* ========== SECURITY SYSTEM ========== */
class SecuritySystem {
    constructor() {
        this.bannedPatterns = [
            /n[i1!]gg[e3]r/gi, /f[a4@]gg[o0]t/gi, /k[y1!]s/gi,
            /r[a4@][i1!]d/gi, /dd[o0]s/gi, /nuk[e3]/gi,
            /h[i1!]tl[e3]r/gi, /n[a4@]z[i1!]/gi,
            /ch[i1!]ldp[o0]rn/gi, /\bc\s*p\b/gi,
            /suic[i1!]d[e3]/gi, /t[e3]rr[o0]r[i1!]st/gi,
            /m[a4@]lw[a4@]r[e3]/gi, /gr[a4@]bb[e3]r/gi,
            /st[e3][a4@]l/gi, /h[a4@]ck/gi, /[e3]xpl[o0][i1!]t/gi,
            /sc[a4@]m/gi, /sp[a4@]m/gi, /r[a4@]t\b/gi,
            /k[e3]yl[o0]gg[e3]r/gi, /v[i1!]rus/gi,
            /tr[o0]j[a4@]n/gi, /r[a4@]ns[o0]mw[a4@]r[e3]/gi
        ];
    }

    analyzeText(text) {
        const normalized = text.toLowerCase()
            .replace(/[^\w\s]/g, '')
            .replace(/[0o]/g, 'o')
            .replace(/[1il]/g, 'i')
            .replace(/[3e]/g, 'e')
            .replace(/[4a@]/g, 'a')
            .replace(/[5s$]/g, 's');

        for (const pattern of this.bannedPatterns) {
            if (pattern.test(normalized)) {
                return { blocked: true, reason: 'Inappropriate content detected' };
            }
        }

        if (/(.)\1{7,}/.test(text)) {
            return { blocked: true, reason: 'Spam pattern detected' };
        }

        const urlCount = (text.match(/https?:\/\//gi) || []).length;
        if (urlCount > 2) {
            return { blocked: true, reason: 'Multiple URLs detected' };
        }

        return { blocked: false };
    }

    async reportThreat(type, data) {
        if (!SECURITY_WEBHOOK || SECURITY_WEBHOOK === "YOUR_SECURITY_WEBHOOK_HERE") return;
        try {
            await fetch(SECURITY_WEBHOOK, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    embeds: [{
                        title: " Security Alert",
                        description: `**Type:** ${type}\n**Data:** ${JSON.stringify(data)}`,
                        color: 0xed4245,
                        timestamp: new Date().toISOString()
                    }]
                })
            });
        } catch (e) {}
    }
}
const security = new SecuritySystem();
function updateTimestamps() {
    const now = new Date();
    const time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
    document.getElementById('timestamp1').textContent = time;
    document.getElementById('timestamp2').textContent = time;
    document.getElementById('timestamp3').textContent = time;
    document.getElementById('timestamp4').textContent = time;
}
async function verifyAccessKey() {
    const key = document.getElementById('accessKey').value.trim();
    if (attemptCount >= 5) {
        showAlert('keyStatus', ' Too many failed attempts. Access blocked.', 'error');
        document.getElementById('accessKey').disabled = true;
        return;
    }
    if (key === ACCESS_KEY) {
        showAlert('keyStatus', ' Access key verified!', 'success');
        setTimeout(() => {
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
            scrollToBottom();
        }, 1000);
    } else {
        attemptCount++;
        showAlert('keyStatus', ` Invalid access key (${5 - attemptCount} attempts remaining)`, 'error');
        security.reportThreat('Failed Access Key', { attempts: attemptCount });
    }
}
async function initiateRobloxVerification() {
    const username = document.getElementById('robloxName').value.trim();
    if (!username) {
        showAlert('robloxStatus', ' Please enter a Roblox username', 'error');
        return;
    }
    const analysis = security.analyzeText(username);
    if (analysis.blocked) {
        showAlert('robloxStatus', `        ${analysis.reason}`, 'error');
        security.reportThreat('Blocked Username', { username, reason: analysis.reason });
        return;
    }
    showAlert('robloxStatus', '<span class="loading"></span> Looking up Roblox account...', 'info');
    try {
        const response = await fetch("https://users.roblox.com/v1/usernames/users", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ usernames: [username], excludeBannedUsers: false })
        });
        const data = await response.json();
        if (!data.data || data.data.length === 0) {
            showAlert('robloxStatus', ' Username not found on Roblox', 'error');
            return;
        }
        robloxId = data.data[0].id;
        currentUsername = username;
        const stored = await localforage.getItem(robloxId.toString());
        if (stored && stored.verified) {
            verifiedOwner = true;
            showAlert('robloxStatus', ` Account already verified!`, 'success');
            setTimeout(() => {
                document.getElementById('step2').style.display = 'none';
                document.getElementById('step4').style.display = 'block';
                scrollToBottom();
                updatePreview();
            }, 1500);
            return;
        }
        verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
        showAlert('robloxStatus', ' Account found! Proceeding to verification...', 'success');
        setTimeout(() => {
            document.getElementById('step2').style.display = 'none';
            document.getElementById('step3').style.display = 'block';
            document.getElementById('verificationCode').textContent = verificationCode;
            scrollToBottom();
        }, 1500);
    } catch (error) {
        showAlert('robloxStatus', ' Network error. Please try again.', 'error');
    }
}
function copyCode() {
    const code = document.getElementById('verificationCode').textContent;
    navigator.clipboard.writeText(code);
    
    const btn = event.target;
    const originalText = btn.textContent;
    btn.textContent = 'Copied!';
    setTimeout(() => {
        btn.textContent = originalText;
    }, 2000);
}

async function verifyRobloxBio() {
    showAlert('bioStatus', '<span class="loading"></span> Checking your Roblox bio...', 'info');

    try {
        const proxyUrl = `https://corsproxy.io/?https://www.roblox.com/users/${robloxId}/profile`;
        const response = await fetch(proxyUrl);
        const html = await response.text();

        if (html.includes(verificationCode)) {
            verifiedOwner = true;
            
            await localforage.setItem(robloxId.toString(), {
                verified: true,
                timestamp: Date.now(),
                username: currentUsername
            });

            showAlert('bioStatus', ' Verification successful! Loading main app...', 'success');
            setTimeout(() => {
                document.getElementById('step3').style.display = 'none';
                document.getElementById('step4').style.display = 'block';
                scrollToBottom();
                updatePreview();
            }, 1500);
        } else {
            showAlert('bioStatus', ` Code not found in bio. Make sure you added: ${verificationCode}`, 'error');
        }
    } catch (error) {
        showAlert('bioStatus', ' Could not verify bio. Please try again.', 'error');
    }
}

/* ========== STEP 4: SEND WEBHOOK ========== */
async function sendWebhook() {
    if (!verifiedOwner) {
        showAlert('sendStatus', ' Please verify ownership first', 'error');
        return;
    }

    const item = document.getElementById('item').value.trim();
    const image = document.getElementById('imageUrl').value.trim();

    if (!item) {
        showAlert('sendStatus', ' Please enter a description', 'error');
        return;
    }

    const analysis = security.analyzeText(item);
    if (analysis.blocked) {
        showAlert('sendStatus', ` ${analysis.reason}`, 'error');
        security.reportThreat('Blocked Webhook Content', { 
            username: currentUsername, 
            content: item, 
            reason: analysis.reason 
        });
        return;
    }

    const color = document.getElementById('embedColor').value;
    const template = document.getElementById('template').value;

    let embed = {};

    if (template === "default") {
        embed = {
            title: " Middleman Completed",
            description: `**User:** ${currentUsername}\n**Transaction:** ${item}`,
            color: parseInt(color.replace("#", ""), 16),
            thumbnail: image ? { url: image } : undefined,
            timestamp: new Date().toISOString(),
            footer: { text: "RecentSender Advanced" }
        };
    } else if (template === "compact") {
        embed = {
            description: `**${currentUsername}** - ${item}`,
            color: parseInt(color.replace("#", ""), 16)
        };
    } else if (template === "imageOnly") {
        embed = {
            image: image ? { url: image } : undefined,
            color: parseInt(color.replace("#", ""), 16),
            footer: { text: currentUsername }
        };
    }

    try {
        showAlert('sendStatus', '<span class="loading"></span> Sending webhook...', 'info');

        await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                username: "RecentSender",
                embeds: [embed]
            })
        });

        showAlert('sendStatus', ' Webhook sent successfully!', 'success');
    } catch (error) {
        showAlert('sendStatus', ' Failed to send webhook. Check your URL.', 'error');
    }
}

/* ========== PREVIEW SYSTEM ========== */
function updatePreview() {
    const item = document.getElementById('item').value.trim();
    const img = document.getElementById('imageUrl').value.trim();
    const color = document.getElementById('embedColor').value;
    const template = document.getElementById('template').value;

    const preview = document.getElementById('previewEmbed');
    
    let previewHTML = '';

    if (template === "default") {
        previewHTML = `
            <div class="embed" style="border-left-color: ${color};">
                <div class="embed-title"> Middleman Completed</div>
                <div class="embed-description">
                    <strong>User:</strong> ${currentUsername || 'Username'}<br>
                    <strong>Transaction:</strong> ${item || 'Your description here...'}
                </div>
                ${img ? `<img src="${img}" style="width: 100%; border-radius: 8px; margin-top: 12px;">` : ''}
            </div>
        `;
    } else if (template === "compact") {
        previewHTML = `
            <div class="embed" style="border-left-color: ${color};">
                <div class="embed-description">
                    <strong>${currentUsername || 'Username'}</strong> - ${item || 'Description'}
                </div>
            </div>
        `;
    } else if (template === "imageOnly") {
        previewHTML = `
            <div class="embed" style="border-left-color: ${color};">
                ${img ? `<img src="${img}" style="width: 100%; border-radius: 8px;">` : '<div class="embed-description">No image provided</div>'}
                <div style="margin-top: 8px; opacity: 0.7; font-size: 14px;">${currentUsername || 'Username'}</div>
            </div>
        `;
    }

    preview.innerHTML = previewHTML;
}

/* ========== UTILITY FUNCTIONS ========== */
function showAlert(elementId, message, type) {
    const element = document.getElementById(elementId);
    element.innerHTML = `<div class="alert ${type}">${message}</div>`;
}

function scrollToBottom() {
    const chatArea = document.getElementById('chatArea');
    setTimeout(() => {
        chatArea.scrollTop = chatArea.scrollHeight;
    }, 100);
}

/* ========== INITIALIZATION ========== */
window.addEventListener('load', () => {
    updateTimestamps();
    setInterval(updateTimestamps, 60000);
    
    // Disable inspect element
    document.addEventListener('contextmenu', e => e.preventDefault());
    
    // Clear selection
    document.addEventListener('selectstart', e => {
        if (e.target.classList.contains('code-block') || 
            e.target.closest('.code-block') ||
            e.target.id === 'verificationCode') {
            return true; // Allow selection in code blocks
        }
        e.preventDefault();
    });
});

// Detect window resize (dev tools opening)
let devtoolsOpen = false;
const threshold = 160;

setInterval(() => {
    if (window.outerWidth - window.innerWidth > threshold || 
        window.outerHeight - window.innerHeight > threshold) {
        if (!devtoolsOpen) {
            devtoolsOpen = true;
            document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100vh;font-size:24px;color:#ed4245;">⚠️ DevTools Detected</div>';
        }
    }
}, 1000);
</script>
</body>
</html>
